<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="Michael F. Lamb" />
  <title>Cookbook</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="/makebakery/_/css/bootstrap-3.4.1.min.css" />
  <link rel="stylesheet" href="/makebakery/_/css/bootstrap-theme-3.4.1.min.css" />
  <link rel="stylesheet" href="/makebakery/_/css/style.css" />
</head>
<body>

<nav class="navbar navbar-inverse navbar-fixed-top">
  <div class="container">

    <a href="https://github.com/datagrok/makebakery"><img style="position: absolute; top: 0; right: 0; border: 0;" src="/makebakery/_/img/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"></a>

    <div class="navbar-header">
      <button type="button" class="btn btn-default navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
        <span class="glyphicon glyphicon-folder-open"></span>
      </button>
      <a class="navbar-brand" href="/makebakery/">makebakery</a>
    </div>

    <div class="navbar-collapse collapse">
      <ul class="nav navbar-nav"></ul>
    </div>

  </div>
</nav>

<!-- Let's not demo the breadcrumb navigation until it works automatically.
<div class="container">
  <ol class="breadcrumb">
    <li><a href="#"></a></li>
    <li><a href="#">Library</a></li>
    <li class="active">Data</li>
  </ol>
</div>
-->

<div class="container">

<header id="title-block-header">
<h1 class="title">Cookbook</h1>
<p class="author">Michael F. Lamb</p>
<p class="date">Fri, 23 Apr 2021 15:17:30 -0700</p>
</header>
<h2 id="how-do-i">How do I…?</h2>
<h3 id="make-make-go-faster">Make <code>make</code> go faster</h3>
<pre><code>make -r -j</code></pre>
<p><code>-r</code> (or <code>--no-builtin-rules</code>) turns off several built-in compilation rules that GNU Make includes by default that are useful for compiling software. Turning them off makes it so it doesn’t have to try as hard to figure out the steps to transform your source files into your rendered files.</p>
<p><code>-j</code> (or <code>--jobs</code>) causes make to run its compilation steps in parallel whenever it is safe to do so.</p>
<h3 id="preview-my-changes">Preview my changes</h3>
<pre><code>python3 -m http.server</code></pre>
<p>I like to start a little local webserver to preview my changes before deploying to the public internet.</p>
<p>There’s many ways to do this. Each of these commands will start a webserver that serves its current directory at http://localhost:8000, if you have the software installed.</p>
<ul>
<li>Python 2: <code>python -m SimpleHTTPServer</code> (stop using Python 2.)</li>
<li>Python 3: <code>python3 -m http.server 8000</code></li>
<li>Ruby: <code>ruby -run -e httpd . -p 8000</code></li>
<li>PHP: <code>php -S localhost:8000</code></li>
<li>busybox: <code>busybox httpd -f -p 8000</code></li>
</ul>
<p>TODO: build a module for this, so you can add <code>MODULES= ... webserver</code> and then <code>make serve</code></p>
<h3 id="automatically-update-the-preview-site-whenever-i-modify-a-file">Automatically update the preview site whenever I modify a file</h3>
<pre><code>sudo apt install inotify-tools
inotifywait -rme close_write . | while read dir event filename
    do
        [ -e &quot;$dir$filename&quot; ] || continue
        make -r -j
    done</code></pre>
<ul>
<li>A more robust version might add <code>--exclude</code> arguments to avoid git actions and swap files</li>
<li>Not working with vim? try <code>:set nowritebackup</code></li>
</ul>
<h3 id="automatically-update-the-preview-browser-tab-whenever-the-site-changes">Automatically update the preview browser tab whenever the site changes</h3>
<pre><code></code></pre>
<p>TODO.</p>
<p>I think the simplest way to accomplish this will be to connect up:</p>
<ul>
<li>inotify watching the preview site output directory with</li>
<li>a tiny server serving a long-poll endpoint, and</li>
<li>a scrap of javascript inserted to every page that long-polls the endpoint.</li>
</ul>
<p>When inotify sees a file has been modified, the server emits the path of the modified data to waiting long-poll requests. The JavaScript waiting on the long-poll response calls window.location.reload() when window.location matches the received path.</p>
<h3 id="automatically-update-the-published-site-whenever-i-git-commit">Automatically update the published site whenever I <code>git commit</code></h3>
<pre><code></code></pre>
<h3 id="remove-the-.html-extension-from-my-static-sites-urls">Remove the .html extension from my static site’s URLs</h3>
<pre><code>...
MODULES = paths_are_dirs ...
...</code></pre>
<p>Use the <code>paths_are_dirs</code> module.</p>
<h3 id="expand-some-variables-in-a-file">Expand some variables in a file</h3>
<p>Use a templating plugin like <code>_m4</code>, or do a one-off manual template using <code>executable</code>.</p>
<h4 id="using-executable-for-templating">Using <code>executable</code> for templating</h4>
<div class="sourceCode" id="cb7"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true"></a><span class="co">#!/bin/sh</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true"></a><span class="fu">cat</span> <span class="op">&lt;&lt;EOF</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true"></a>&lt;html&gt;</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true"></a>&lt;p&gt;This file was generated by <span class="va">$USER</span>.&lt;/p&gt;</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true"></a>&lt;/html&gt;</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true"></a><span class="op">EOF</span></span></code></pre></div>
<h3 id="make-a-blog">Make a blog</h3>
<h3 id="make-an-atom-feed">Make an atom feed</h3>
<h3 id="make-a-site-map">Make a site-map</h3>
<h3 id="make-a-site-map-that-requires-no-javascript">Make a site-map that requires no JavaScript</h3>
<h3 id="make-a-navigation-bar-that-automatically-updates-itself">Make a navigation bar that automatically updates itself</h3>

</div> <!-- /container -->

<!-- Le javascript
================================================== -->
<!-- Placed at the end of the document so the pages load faster -->
<script src="/makebakery/_/js/jquery-3.6.0.min.js"></script>
<script src="/makebakery/_/js/bootstrap-3.4.1.min.js"></script>

<!--  Get some other variables useful to javascript into the page context. -->
<script type="text/javascript">
  var site_root = "/makebakery/";
</script>

<!--  this is where we put our custom functions -->
<script src="/makebakery/_/js/functions.js"></script>

</body>
</html>
